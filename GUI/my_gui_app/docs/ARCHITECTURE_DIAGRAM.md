# Clean Architecture 다이어그램

## 레이어 의존성 흐름

```
┌─────────────────────────────────────────────────────────┐
│                    bin/main.ml                          │
│                  (Entry Point)                          │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────┐
│              Presentation Layer                         │
│  ┌──────────────────┐    ┌──────────────────┐          │
│  │ app_controller.ml│◄───┤window_builder.ml │          │
│  │  - 이벤트 핸들링  │    │  - UI 컴포넌트   │          │
│  │  - 상태 동기화    │    │  - 위젯 생성     │          │
│  └────────┬─────────┘    └──────────────────┘          │
└───────────┼─────────────────────────────────────────────┘
            │
            ▼
┌─────────────────────────────────────────────────────────┐
│              Application Layer                          │
│  ┌──────────────────────────────────────────┐           │
│  │           use_cases.ml                   │           │
│  │  - update_input()                        │           │
│  │  - handle_submit()                       │           │
│  │  - handle_event()                        │           │
│  └────────────────┬─────────────────────────┘           │
└───────────────────┼─────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────────────┐
│                 Domain Layer                            │
│  ┌──────────────┐         ┌──────────────┐             │
│  │  types.ml    │         │  events.ml   │             │
│  │ - app_state  │         │ - InputChanged│            │
│  │ - initial_   │         │ - SubmitClicked│           │
│  │   state      │         │ - QuitRequested│           │
│  └──────────────┘         └──────────────┘             │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│            Infrastructure Layer                         │
│  ┌──────────────────────────────────────────┐           │
│  │          gtk_adapter.ml                  │           │
│  │  - init_gtk()                            │           │
│  │  - run_main_loop()                       │           │
│  │  - update_label_text()                   │           │
│  │  - get_entry_text()                      │           │
│  └──────────────┬───────────────────────────┘           │
└─────────────────┼───────────────────────────────────────┘
                  │
                  ▼
            ┌──────────┐
            │ LablGTK3 │
            └──────────┘
```

## 데이터 흐름

### 사용자 입력 처리 흐름

```
1. 사용자가 버튼 클릭
   │
   ▼
2. Presentation (app_controller.ml)
   - 이벤트 감지
   - Infrastructure에서 입력 텍스트 가져오기
   │
   ▼
3. Application (use_cases.ml)
   - update_input(): 상태 업데이트
   - handle_submit(): 비즈니스 로직 처리
   │
   ▼
4. Domain (types.ml)
   - 새로운 app_state 생성
   │
   ▼
5. Presentation (app_controller.ml)
   - sync_ui_with_state(): UI 업데이트
   │
   ▼
6. Infrastructure (gtk_adapter.ml)
   - update_label_text(): GTK 위젯 업데이트
```

## 모듈 간 통신

```
┌──────────────┐
│ Presentation │──┐
└──────────────┘  │
                  │ 호출
┌──────────────┐  │
│ Application  │◄─┘
└──────────────┘  │
                  │ 사용
┌──────────────┐  │
│   Domain     │◄─┘
└──────────────┘

┌──────────────┐
│ Presentation │──┐
└──────────────┘  │ 호출
                  │
┌──────────────┐  │
│Infrastructure│◄─┘
└──────────────┘
```

## 테스트 전략

각 레이어는 독립적으로 테스트 가능:

- **Domain**: 순수 함수 테스트 (외부 의존성 없음)
- **Application**: 유스케이스 로직 테스트 (Domain만 의존)
- **Infrastructure**: GTK 어댑터 모킹 가능
- **Presentation**: 통합 테스트
